<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
[Назад](README.md)<br />**Содержание**

- [React-компоненты](#react-%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D1%8B)
  - [Определение](#%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5)
  - [Синтаксис](#%D1%81%D0%B8%D0%BD%D1%82%D0%B0%D0%BA%D1%81%D0%B8%D1%81)
  - [JSX](#jsx)
    - [Определение](#%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-1)
    - [Встраивание выражений](#%D0%B2%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B2%D1%8B%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9)
      - [Условия](#%D1%83%D1%81%D0%BB%D0%BE%D0%B2%D0%B8%D1%8F)
    - [Атрибуты](#%D0%B0%D1%82%D1%80%D0%B8%D0%B1%D1%83%D1%82%D1%8B)
    - [Компоненты](#%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D1%8B)
  - [Жизненный цикл](#%D0%B6%D0%B8%D0%B7%D0%BD%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9-%D1%86%D0%B8%D0%BA%D0%BB)
  - [Состояние](#%D1%81%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B5)
  - [Параметры](#%D0%BF%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8B)
  - [Что дальше](#%D1%87%D1%82%D0%BE-%D0%B4%D0%B0%D0%BB%D1%8C%D1%88%D0%B5)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# React-компоненты

## Определение

**React-компонент** – отдельная функция или класс (конструктор), которая может быть использована библиотекой React независимо от других компонентов. Инкапсулируют в себе логику и/или отображение. Здесь рассматриваются только функциональные компоненты, описание классовых [здесь](/react-components-classes.md).

> Инкапсуляция – скрытие, содержание в объекте данных и методов, связанных с ним, и недоступных "снаружи"

## Синтаксис

React-компонент технически – обычная функция. Чтобы она определялась инструментами, как компонент, её название должно начинаться с большой буквы. 

Компонент должен возвращать одно из двух значений:

* null
* дерево элементов, обычно описываемое с помощью JSX

> Возвращаемое дерево должно "начинаться" с единственного элемента. Вернуть несколько элементов нельзя, если они не находятся внутри общего родителя.

> Например:
>
> ```javascript
> const Input = ({label, value, onChange}) => {
>   return (
>     <div className="input">
>       <div className="input__label">
>        	{label}
>       </div>
>       <input
>         className="input__input"
>         value={value}
>         onChange={onChange}
>       />
>     </div>
>   );
> }
> ```

## JSX

### Определение

**JSX** – это расширение языка JavaScript, созданное для упрощения описания интерфейсов. Он позволяет описывать в JS дерево элементов наподобие того, как мы бы делали это в HTML.

Например, вот простое JSX-выражение:

```javascript
const h1 = <h1>Привет</h1>;
```

### Встраивание выражений

В JSX можно встроить любые корректные JavaScript-выражения (например, `2 + 2` или `'Привет, ' + name`, или `getSomething(false)`). В том числе, встраивать можно и JSX-выражения.

Для встраивания используются фигурные скобки (немного похоже на [шаблонные строки](template_strings.md)):

```javascript
const page = <div>
  {h1}
  <div>Вы вошли как {username}</div>
</div>
```

#### Условия

Частым случаем использования выражений в JSX являются условия. Так блок разметки показывается только тогда, когда условие выполнено:

```javascript
const page = <div>
  {h1}
  {auth  && <div>Вы вошли как {username}</div>}
  {!auth && <div>
    <div>Вы не вошли в аккаунт.</div>
    <button>Войти</button>
  </div>}
</div>
```

### Атрибуты

JSX позволяет передавать элементам атрибуты так же, как и в HTML. Значения строчного типа можно передавать только в двойных скобках, а значения любых других – внутри фигурных скобок:

```javascript
const image1 = <img src="https://...">;
```

```javascript
const image2 = <img src={`https://${host}/${filePath}`}>;
```

```javascript
const title = <Title authorized={true} messagesCount={count}>;
```

Значением атрибута может быть и JSX-выражение:

```javascript
<Popup
  content={<div>...</div>}
  closeButton={<button>...</button>}
/>
```

Для значений `true` можно передать только название:

```javascript
const title = <Title authorized messagesCount={count}>;
```

### Компоненты

Если название элемента начинается с большой буквы, JSX считает, что это компонент. Тогда передаваемые атрибуты попадут в параметры (props) компонента.

## Жизненный цикл

У компонента есть три стадии жизненного цикла: 

* Монтирование. На этой стадии компонент подключается к дереву, происходит первый рендеринг (отрисовка), инициализируются все нужные данные
* Обновление. В случае, если состояние или параметры поменялись, функция компонента вызывается заново, и если результат отличается, изменения вносятся в документ
* Удаление. Компонент удаляется из дерева, все связанные с ним данные удаляются

## Состояние

**Состояние** – одна из двух групп данных, которые определяют, должен ли обновиться компонент. Состояние это то, что мы можем описать, когда говорим что-то вроде "сейчас диалоговое окно открыто" или "сейчас в поле введен какой-то текст". 

Иначе можно сказать, что **состояние** – это данные, которые используются в компоненте, могут обновляться, и от которых может зависеть его внутренняя логика или вывод. Когда меняется состояние, реакт запускает обновление.

------

Для использования состояния в React есть [хук](react-hooks.md) useState. Он принимает два варианта значений:

* Значение по умолчанию
* Функцию, тогда она будет вызвана для получения значения по умолчанию

Возвращает useState всегда массив. Первый элемент массива – текущее значение этого состояния. Второй – функция, в которую нужно передать новое значение, если оно должно измениться. 

```javascript
const Counter = () => {
  const [count, setCount] = useState(0);
  return (
    <div>
      {count}
      <button onClick={() => setCount(count + 1)}>+</button>
    </div>
  );
}
```

> Здесь у компонента `Counter` есть состояние `count` и функция для его обновления `setCount`. Когда компонент монтируется, в `count` попадает `0`, потому что он передан `useState`. 
>
> При монтировании Реакт вызывает `Counter` и получает дерево, в котором выведет текст `0` и кнопка. 
>
> При нажатии на кнопку происходит вызов `setCount(count + 1)`, что говорит реакту, что новое значение `count` – `1`. 
>
> Реакт снова вызывает функцию `Counter`, но на этот раз компонент получает в переменную `count` новое значение, и в возвращенном дереве будет число `1`. Тогда в процессе сверки `0` в документе заменится на `1`, что приведет интерфейс к актуальному состоянию.

## Параметры

Если при использовании компонента, передать ему атрибуты, они будут доступны внутри него. Все атрибуты попадают в объект, который передается компоненту на каждом этапе его жизненного цикла:

```javascript
const Number = ({ value, color }) => (
  <span style={{color}}>{value}</span>
);

const Page = () => (
  <div>
    Число: <Number value={7} color="red" />
  </div>
);
```

Как и при работе с состоянием, изменение параметров ведет к обновлению компонента.

## Что дальше

* [Списки и ключи](react-key.md)
* [Управляемые и неуправляемые компоненты](react-controllable.md)
* [Подъем состояния](react-lifting-state-up.md)
* [Хуки](react-hooks.md)